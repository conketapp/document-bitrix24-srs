@startuml DMDA-2.4 Activity Diagram
!theme plain
skinparam activityFontSize 12

title DMDA-2.4: Activity Diagram - Dừng Thực hiện Dự án

start

:Người dùng chọn dự án cần dừng thực hiện;

:Kiểm tra quyền dừng dự án;

if (Có quyền dừng dự án?) then (Không)
    :Hiển thị thông báo "Không có quyền dừng dự án";
    stop
else (Có)
    :Kiểm tra trạng thái dự án;
    
    if (Trạng thái = approved/in_progress?) then (Có)
        :Hiển thị nút "Dừng thực hiện";
        :Người dùng nhấn "Dừng thực hiện";
        :Hiển thị confirmation dialog;
        :Hiển thị thông tin dự án cần dừng;
        :Yêu cầu nhập lý do dừng thực hiện;
        :Người dùng nhập lý do dừng thực hiện;
        :Người dùng xác nhận dừng thực hiện;
        :Cập nhật trạng thái dự án thành "suspended";
        :Ghi log thay đổi trạng thái;
        :Thông báo cho stakeholders;
        :Đồng bộ trạng thái với Bitrix24;
        :Gửi thông báo thành công;
        :Cập nhật danh sách dự án;
        
    else (Trạng thái khác)
        if (Trạng thái = draft/pending_approval?) then (Có)
            :Hiển thị thông báo "Dự án chưa được phê duyệt, không thể dừng thực hiện";
        else (Trạng thái khác)
            if (Trạng thái = completed?) then (Có)
                :Hiển thị thông báo "Dự án đã hoàn thành, không thể dừng thực hiện";
            else (Trạng thái khác)
                if (Trạng thái = suspended?) then (Có)
                    :Hiển thị thông báo "Dự án đã dừng thực hiện";
                else (cancelled/deleted)
                    :Hiển thị thông báo "Dự án đã bị hủy/xóa";
                endif
            endif
        endif
    endif
endif

stop

@enduml
