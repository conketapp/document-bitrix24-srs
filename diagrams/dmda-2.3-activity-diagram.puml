@startuml DMDA-2.3 Activity Diagram
!theme plain
skinparam activityFontSize 12

title DMDA-2.3: Activity Diagram - Xóa Dự án

start

:Người dùng chọn dự án cần xóa;

:Kiểm tra quyền xóa dự án;

if (Có quyền xóa dự án?) then (Không)
    :Hiển thị thông báo "Không có quyền xóa";
    stop
else (Có)
    :Kiểm tra trạng thái dự án;
    
    if (Trạng thái = draft/pending_approval?) then (Có)
        :Hiển thị nút "Xóa";
        :Người dùng nhấn "Xóa";
        :Hiển thị confirmation dialog;
        :Hiển thị thông tin dự án cần xóa;
        :Yêu cầu nhập lý do xóa;
        :Người dùng nhập lý do xóa;
        :Người dùng xác nhận xóa;
        :Thực hiện soft delete;
        :Cập nhật deleted_at, deleted_by, delete_reason;
        :Cập nhật status = 'deleted';
        :Xóa related data;
        :Ghi log xóa dự án;
        :Đồng bộ xóa với Bitrix24;
        :Gửi thông báo thành công;
        :Cập nhật danh sách dự án;
        
    else (Trạng thái khác)
        :Hiển thị thông báo "Không thể xóa dự án";
        :Gợi ý sử dụng chức năng "Hủy dự án";
    endif
endif

stop

@enduml
